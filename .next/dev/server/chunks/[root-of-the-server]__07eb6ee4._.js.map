{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///Users/gbrs/Documents/git-projects/budafoki-zarandokhaz-web/app/api/artworks/route.ts"],"sourcesContent":["import { NextRequest } from \"next/server\"\nimport fs from \"node:fs\"\nimport path from \"node:path\"\n\nconst ART_PATH = path.join(process.cwd(), \"lib\", \"artworks-data.tsx\")\nexport const runtime = \"nodejs\"\nexport const dynamic = \"force-dynamic\"\n\nfunction loadArtworks(): any[] {\n  try {\n    const src = fs.readFileSync(ART_PATH, \"utf8\")\n    const start = src.indexOf(\"export const allArtworks\")\n    if (start === -1) return []\n    const bracketStart = src.indexOf(\"[\", start)\n    const sentinel = \"]\\n\\nexport function getArtwork\"\n    const endIdx = src.indexOf(sentinel, bracketStart)\n    if (bracketStart === -1 || endIdx === -1) return []\n    const arrayStr = src.slice(bracketStart, endIdx)\n    // eslint-disable-next-line no-new-func\n    const fn = new Function(\"return \" + arrayStr)\n    const arr = fn()\n    return Array.isArray(arr) ? arr : []\n  } catch {\n    return []\n  }\n}\n\nfunction buildFileContent(items: any[]): string {\n  const header = `export interface Artwork {\\n  id: number\\n  src: string\\n  title: string\\n  artist: string\\n  medium: string\\n  year: string\\n  size: string\\n}\\n\\nexport const allArtworks: Artwork[] = [\\n`\n  const entries = items\n    .map((a) => {\n      return `  { id: ${a.id}, src: ${JSON.stringify(a.src)}, title: ${JSON.stringify(a.title)}, artist: ${JSON.stringify(a.artist)}, medium: ${JSON.stringify(a.medium)}, year: ${JSON.stringify(a.year)}, size: ${JSON.stringify(a.size)} },\\n`\n    })\n    .join(\"\")\n  const footer = `]\\n\\nexport function getArtwork(id: number): Artwork | undefined {\\n  return allArtworks.find((a) => a.id === id)\\n}\\n`\n  return header + entries + footer\n}\n\nexport async function GET() {\n  const arr = loadArtworks()\n  if (arr.length === 0) {\n    try {\n      const mod = await import(\"@/lib/artworks-data\")\n      return Response.json(mod.allArtworks ?? [])\n    } catch {\n      return Response.json([])\n    }\n  }\n  return Response.json(arr)\n}\n\nexport async function POST(req: NextRequest) {\n  const isAdmin = req.cookies.get(\"admin\")?.value === \"1\"\n  if (!isAdmin) return new Response(\"Unauthorized\", { status: 401 })\n  const body = await req.json()\n  let items = loadArtworks().slice()\n  if (!items.length) {\n    try {\n      const mod = await import(\"@/lib/artworks-data\")\n      items = (mod.allArtworks ?? []).slice()\n    } catch {\n      items = []\n    }\n  }\n  const nextId = items.length ? Math.max(...items.map((i) => i.id)) + 1 : 1\n  const newItem = {\n    id: nextId,\n    src: String(body.src || \"/placeholder.svg\"),\n    title: String(body.title || \"Untitled\"),\n    artist: String(body.artist || \"\"),\n    medium: String(body.medium || \"\"),\n    year: String(body.year || \"\"),\n    size: String(body.size || \"\"),\n  }\n  const content = buildFileContent([newItem, ...items])\n  fs.writeFileSync(ART_PATH, content, \"utf8\")\n  return Response.json({ ok: true, item: newItem })\n}\n"],"names":[],"mappings":"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"}}]
}